{"version":3,"file":"index.f7288490.js","sources":["../../../../ui/packages/icons/src/Chat.svelte","../../../../ui/packages/chatbot/src/ChatBot.svelte","../../../../ui/packages/app/src/components/Chatbot/Chatbot.svelte","../../../../ui/packages/app/src/components/Chatbot/index.ts"],"sourcesContent":["<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\txmlns:xlink=\"http://www.w3.org/1999/xlink\"\n\taria-hidden=\"true\"\n\trole=\"img\"\n\tclass=\"iconify iconify--carbon\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tpreserveAspectRatio=\"xMidYMid meet\"\n\tviewBox=\"0 0 32 32\"\n>\n\t<path\n\t\tfill=\"currentColor\"\n\t\td=\"M17.74 30L16 29l4-7h6a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h9v2H6a4 4 0 0 1-4-4V8a4 4 0 0 1 4-4h20a4 4 0 0 1 4 4v12a4 4 0 0 1-4 4h-4.84Z\"\n\t/>\n\t<path fill=\"currentColor\" d=\"M8 10h16v2H8zm0 6h10v2H8z\" />\n</svg>\n","<script lang=\"ts\">\n\timport { beforeUpdate, afterUpdate, createEventDispatcher } from \"svelte\";\n\timport type { Styles, SelectData } from \"@gradio/utils\";\n\timport type { FileData } from \"@gradio/upload\";\n\n\texport let value: Array<\n\t\t[string | FileData | null, string | FileData | null]\n\t> | null;\n\tlet old_value: Array<\n\t\t[string | FileData | null, string | FileData | null]\n\t> | null = null;\n\texport let pending_message: boolean = false;\n\texport let feedback: Array<string> | null = null;\n\texport let style: Styles = {};\n\texport let selectable: boolean = false;\n\n\tlet div: HTMLDivElement;\n\tlet autoscroll: Boolean;\n\n\tconst dispatch = createEventDispatcher<{\n\t\tchange: undefined;\n\t\tselect: SelectData;\n\t}>();\n\n\tbeforeUpdate(() => {\n\t\tautoscroll =\n\t\t\tdiv && div.offsetHeight + div.scrollTop > div.scrollHeight - 20;\n\t});\n\n\tafterUpdate(() => {\n\t\tif (autoscroll) {\n\t\t\tdiv.scrollTo(0, div.scrollHeight);\n\t\t\tdiv.querySelectorAll(\"img\").forEach((n) => {\n\t\t\t\tn.addEventListener(\"load\", () => {\n\t\t\t\t\tdiv.scrollTo(0, div.scrollHeight);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t});\n\n\t$: {\n\t\tif (value !== old_value) {\n\t\t\told_value = value;\n\t\t\tdispatch(\"change\");\n\t\t}\n\t}\n</script>\n\n<div\n\tclass=\"wrap\"\n\tstyle:height={`${style.height}px`}\n\tstyle:max-height={`${style.height}px`}\n\tbind:this={div}\n>\n\t<div class=\"message-wrap\">\n\t\t{#if value !== null}\n\t\t\t{#each value as message_pair, i}\n\t\t\t\t{#each message_pair as message, j}\n\t\t\t\t\t<div\n\t\t\t\t\t\tdata-testid={j == 0 ? \"user\" : \"bot\"}\n\t\t\t\t\t\tclass:latest={i === value.length - 1}\n\t\t\t\t\t\tclass=\"message {j == 0 ? 'user' : 'bot'}\"\n\t\t\t\t\t\tclass:hide={message === null}\n\t\t\t\t\t\tclass:selectable\n\t\t\t\t\t\ton:click={() =>\n\t\t\t\t\t\t\tdispatch(\"select\", { index: [i, j], value: message })}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if typeof message === \"string\"}\n\t\t\t\t\t\t\t{@html message}\n\t\t\t\t\t\t\t{#if feedback && j == 1}\n\t\t\t\t\t\t\t\t<div class=\"feedback\">\n\t\t\t\t\t\t\t\t\t{#each feedback as f}\n\t\t\t\t\t\t\t\t\t\t<button>{f}</button>\n\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{:else if message !== null && message.mime_type?.includes(\"audio\")}\n\t\t\t\t\t\t\t<audio\n\t\t\t\t\t\t\t\tcontrols\n\t\t\t\t\t\t\t\tpreload=\"metadata\"\n\t\t\t\t\t\t\t\tsrc={message.data}\n\t\t\t\t\t\t\t\ttitle={message.alt_text}\n\t\t\t\t\t\t\t\ton:play\n\t\t\t\t\t\t\t\ton:pause\n\t\t\t\t\t\t\t\ton:ended\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{:else if message !== null && message.mime_type?.includes(\"video\")}\n\t\t\t\t\t\t\t<video\n\t\t\t\t\t\t\t\tcontrols\n\t\t\t\t\t\t\t\tsrc={message.data}\n\t\t\t\t\t\t\t\ttitle={message.alt_text}\n\t\t\t\t\t\t\t\tpreload=\"auto\"\n\t\t\t\t\t\t\t\ton:play\n\t\t\t\t\t\t\t\ton:pause\n\t\t\t\t\t\t\t\ton:ended\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<track kind=\"captions\" />\n\t\t\t\t\t\t\t</video>\n\t\t\t\t\t\t{:else if message !== null && message.mime_type?.includes(\"image\")}\n\t\t\t\t\t\t\t<img src={message.data} alt={message.alt_text} />\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t{/each}\n\t\t{/if}\n\t\t{#if pending_message}\n\t\t\t<div class=\"message pending\">\n\t\t\t\t<div class=\"dot-flashing\" />\n\t\t\t\t&nbsp;\n\t\t\t\t<div class=\"dot-flashing\" />\n\t\t\t\t&nbsp;\n\t\t\t\t<div class=\"dot-flashing\" />\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t.wrap {\n\t\tpadding: var(--block-padding);\n\t\theight: 100%;\n\t\tmax-height: 480px;\n\t\toverflow-y: auto;\n\t}\n\n\t.message-wrap {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xxl);\n\t}\n\n\t.message-wrap > div :global(img) {\n\t\tborder-radius: 13px;\n\t\tmax-width: 30vw;\n\t}\n\n\t.message-wrap :global(audio) {\n\t\twidth: 100%;\n\t}\n\n\t.message {\n\t\tposition: relative;\n\t\talign-self: flex-start;\n\t\tborder-width: 1px;\n\t\tborder-radius: var(--radius-xxl);\n\t\tbackground: var(--background-fill-secondary);\n\t\tpadding: var(--spacing-xxl);\n\t\twidth: calc(100% - var(--spacing-xxl));\n\t\tcolor: var(--body-text-color);\n\t\tfont-size: var(--text-lg);\n\t\tline-height: var(--line-lg);\n\t\toverflow-wrap: break-word;\n\t}\n\t.user {\n\t\talign-self: flex-end;\n\t\tborder-bottom-right-radius: 0;\n\t}\n\t.bot {\n\t\tborder-bottom-left-radius: 0;\n\t\tpadding-left: calc(2 * var(--spacing-xxl));\n\t}\n\t@media (max-width: 480px) {\n\t\t.message {\n\t\t\twidth: auto;\n\t\t}\n\t\t.bot {\n\t\t\tpadding-left: var(--spacing-xxl);\n\t\t}\n\t}\n\n\t/* Colors */\n\t.bot,\n\t.pending {\n\t\tborder-color: var(--border-color-primary);\n\t\tbackground: var(--background-fill-secondary);\n\t}\n\t.user {\n\t\tborder-color: var(--border-color-accent);\n\t\tbackground-color: var(--color-accent-soft);\n\t}\n\t.feedback {\n\t\tdisplay: flex;\n\t\tposition: absolute;\n\t\ttop: var(--spacing-xl);\n\t\tright: calc(var(--spacing-xxl) + var(--spacing-xl));\n\t\tgap: var(--spacing-lg);\n\t\tfont-size: var(--text-sm);\n\t}\n\t.feedback button {\n\t\tcolor: var(--body-text-color-subdued);\n\t}\n\t.feedback button:hover {\n\t\tcolor: var(--body-text-color);\n\t}\n\t.selectable {\n\t\tcursor: pointer;\n\t}\n\n\t.pending {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\talign-self: center;\n\t\tgap: 2px;\n\t}\n\t.dot-flashing {\n\t\tanimation: dot-flashing 1s infinite linear alternate;\n\t\tborder-radius: 5px;\n\t\tbackground-color: var(--body-text-color);\n\t\twidth: 5px;\n\t\theight: 5px;\n\t\tcolor: var(--body-text-color);\n\t}\n\t.dot-flashing:nth-child(2) {\n\t\tanimation-delay: 0.33s;\n\t}\n\t.dot-flashing:nth-child(3) {\n\t\tanimation-delay: 0.66s;\n\t}\n\n\t/* Small screen */\n\t@media (max-width: 480px) {\n\t\t.user {\n\t\t\talign-self: flex-end;\n\t\t}\n\t\t.bot {\n\t\t\talign-self: flex-start;\n\t\t\tpadding-left: var(--size-3);\n\t\t}\n\t}\n\n\t@keyframes dot-flashing {\n\t\t0% {\n\t\t\topacity: 0.8;\n\t\t}\n\t\t50% {\n\t\t\topacity: 0.5;\n\t\t}\n\t\t100% {\n\t\t\topacity: 0.8;\n\t\t}\n\t}\n\t.message-wrap .message :global(img) {\n\t\tmargin: var(--size-2);\n\t\tmax-height: 200px;\n\t}\n\t.message-wrap .message :global(a) {\n\t\tcolor: var(--color-text-link);\n\t\ttext-decoration: underline;\n\t}\n\n\t.hide {\n\t\tdisplay: none;\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { ChatBot } from \"@gradio/chatbot\";\n\timport { Block, BlockLabel } from \"@gradio/atoms\";\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\n\timport type { Styles } from \"@gradio/utils\";\n\timport { Chat } from \"@gradio/icons\";\n\timport type { FileData } from \"@gradio/upload\";\n\timport { normalise_file } from \"@gradio/upload\";\n\n\texport let elem_id: string = \"\";\n\texport let elem_classes: Array<string> = [];\n\texport let visible: boolean = true;\n\texport let value: Array<\n\t\t[string | FileData | null, string | FileData | null]\n\t> = [];\n\tlet _value: Array<[string | FileData | null, string | FileData | null]>;\n\texport let style: Styles = {};\n\texport let label: string;\n\texport let show_label: boolean = true;\n\texport let root: string;\n\texport let root_url: null | string;\n\texport let selectable: boolean = false;\n\n\tconst redirect_src_url = (src: string) =>\n\t\tsrc.replace('src=\"/file', `src=\"${root}file`);\n\n\t$: _value = value\n\t\t? value.map(([user_msg, bot_msg]) => [\n\t\t\t\ttypeof user_msg === \"string\"\n\t\t\t\t\t? redirect_src_url(user_msg)\n\t\t\t\t\t: normalise_file(user_msg, root, root_url),\n\t\t\t\ttypeof bot_msg === \"string\"\n\t\t\t\t\t? redirect_src_url(bot_msg)\n\t\t\t\t\t: normalise_file(bot_msg, root, root_url)\n\t\t  ])\n\t\t: [];\n\texport let loading_status: LoadingStatus | undefined = undefined;\n</script>\n\n<Block {elem_id} {elem_classes} {visible} padding={false}>\n\t{#if show_label}\n\t\t<BlockLabel\n\t\t\t{show_label}\n\t\t\tIcon={Chat}\n\t\t\tfloat={false}\n\t\t\tlabel={label || \"Chatbot\"}\n\t\t\tdisable={typeof style.container === \"boolean\" && !style.container}\n\t\t/>\n\t{/if}\n\t<ChatBot\n\t\t{style}\n\t\t{selectable}\n\t\tvalue={_value}\n\t\tpending_message={loading_status?.status === \"pending\"}\n\t\ton:change\n\t\ton:select\n\t/>\n</Block>\n","export { default as Component } from \"./Chatbot.svelte\";\nexport const modes = [\"static\"];\n\nexport const document = (config: Record<string, any>) => ({\n\ttype: {\n\t\tpayload: \"Array<[string, string]>\"\n\t},\n\tdescription: {\n\t\tpayload: \"list of message pairs of\"\n\t},\n\texample_data: config.value?.length\n\t\t? config.value\n\t\t: [\n\t\t\t\t[\"Hi\", \"Hello\"],\n\t\t\t\t[\"1 + 1\", \"2\"]\n\t\t  ]\n});\n"],"names":[],"mappings":"+oCAAA,SAWC,OAIA,mTCyCS,0BAAL,+JAAK,uBAAL,qIAAA,wFA2CY,MAAQ,IAAI,4BAAO,MAAQ,QAAQ,UAA7C,iCAAU,MAAQ,IAAI,4BAAO,MAAQ,2JAV/B,MAAQ,IAAI,8BACV,MAAQ,QAAQ,gCAHxB,SASC,qGAPK,MAAQ,IAAI,4BACV,MAAQ,4JAVV,MAAQ,IAAI,8BACV,MAAQ,QAAQ,UAJxB,qGAGM,MAAQ,IAAI,4BACV,MAAQ,4EAbT,eACF,MAAY,OAAK,gIADf,kBACF,MAAY,OAAK,oIAEb,0BAAL,sIADH,sEACQ,uBAAL,6HAAA,qDACQ,iFAAT,oCAAS,sIALD,QAAY,oCASd,SAAY,MAAQ,MAAQ,WAAW,SAAS,OAAO,iCAUvD,SAAY,MAAQ,MAAQ,WAAW,SAAS,OAAO,iCAYvD,SAAY,MAAQ,MAAQ,WAAW,SAAS,OAAO,4IAvCpD,OAAK,EAAI,OAAS,KAAK,yBAEpB,QAAK,EAAI,OAAS,sCADpB,QAAM,KAAM,OAAS,CAAC,aAExB,QAAY,IAAI,iCAJ7B,6JAEe,QAAM,KAAM,OAAS,CAAC,kBAExB,QAAY,IAAI,uFALvB,2BAAL,+JAAK,wBAAL,qIAAA;;;;yGAiDH,oDAnDI,OAAU,aAkDV,+JAvDW,KAAM,mCACF,KAAM,uBAH5B,SAMC,+DACM,OAAU,2DAkDV,0EAvDW,KAAM,wCACF,KAAM,4FA9ChB,WAGP,EAEO,MACA,kBAA2B,OAC3B,WAAiC,SACjC,eACA,aAAsB,MAE7B,EACA,OAEE,GAAW,KAKjB,QACC,EACC,GAAO,EAAI,aAAe,EAAI,UAAY,EAAI,aAAe,KAG/D,QACK,GACH,GAAI,SAAS,EAAG,EAAI,YAAY,EAChC,EAAI,iBAAiB,KAAK,EAAE,QAAS,IACpC,EAAE,iBAAiB,YAClB,EAAI,SAAS,EAAG,EAAI,YAAY,sNA+B9B,EAAS,UAAY,OAAQ,EAAG,EAAC,EAAG,MAAO,+CAbtC,kPAXN,IAAU,QACb,EAAY,CAAK,EACjB,EAAS,QAAQ,mOCAX,SACC,SACA,MAAS,wBACA,MAAM,WAAc,YAAc,KAAM,qHADjD,MAAS,iCACA,MAAM,WAAc,YAAc,KAAM,gIANrD,qEAYG,qBACU,MAAgB,SAAW,iJAbxC,wLAYG,gCACU,MAAgB,SAAW,oOAdK,2UA9BvC,UAAkB,OAClB,sBACA,UAAmB,OACnB,cAGP,GACO,eACA,YACA,aAAsB,OACtB,WACA,eACA,aAAsB,WAE3B,GAAoB,GACzB,EAAI,QAAQ,qBAAsB,aAYxB,iBAA4C,wfAVpD,EAAS,EACT,EAAM,MAAM,EAAU,YACf,IAAa,SACjB,EAAiB,CAAQ,EACzB,EAAe,EAAU,EAAM,CAAQ,QACnC,IAAY,SAChB,EAAiB,CAAO,EACxB,EAAe,EAAS,EAAM,CAAQ,+OChChC,IAAQ,CAAC,QAAQ,EAEjB,GAAW,AAAC,KACxB,KAAM,CACL,QAAS,2BAEV,YAAa,CACZ,QAAS,4BAEV,aAAc,EAAO,OAAO,OACzB,EAAO,MACP,CACA,CAAC,KAAM,OAAO,EACd,CAAC,QAAS,GAAG,EAEjB"}