{"version":3,"file":"index.9a6bd3f2.js","sources":["../../../../ui/packages/icons/src/TextHighlight.svelte","../../../../ui/packages/highlighted-text/src/HighlightedText.svelte","../../../../ui/packages/app/src/components/HighlightedText/HighlightedText.svelte","../../../../ui/packages/app/src/components/HighlightedText/index.ts"],"sourcesContent":["<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\txmlns:xlink=\"http://www.w3.org/1999/xlink\"\n\taria-hidden=\"true\"\n\trole=\"img\"\n\tclass=\"iconify iconify--carbon\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tpreserveAspectRatio=\"xMidYMid meet\"\n\tviewBox=\"0 0 32 32\"\n\t><path\n\t\tfill=\"currentColor\"\n\t\td=\"M12 15H5a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5V5a1 1 0 0 0-1-1H3V2h6a3 3 0 0 1 3 3zM5 9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h5V9zm15 14v2a1 1 0 0 0 1 1h5v-4h-5a1 1 0 0 0-1 1z\"\n\t/><path\n\t\tfill=\"currentColor\"\n\t\td=\"M2 30h28V2Zm26-2h-7a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5v-2a1 1 0 0 0-1-1h-6v-2h6a3 3 0 0 1 3 3Z\"\n\t/></svg\n>\n","<script lang=\"ts\">\n\tconst browser = typeof document !== \"undefined\";\n\timport { colors } from \"@gradio/theme\";\n\timport { get_next_color } from \"@gradio/utils\";\n\n\texport let value: Array<[string, string | number]> = [];\n\texport let show_legend: boolean = false;\n\texport let color_map: Record<string, string> = {};\n\n\tlet ctx: CanvasRenderingContext2D;\n\n\tlet _color_map: Record<string, { primary: string; secondary: string }> = {};\n\tlet active = \"\";\n\n\tfunction name_to_rgba(name: string, a: number) {\n\t\tif (!ctx) {\n\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\tctx = canvas.getContext(\"2d\")!;\n\t\t}\n\t\tctx.fillStyle = name;\n\t\tctx.fillRect(0, 0, 1, 1);\n\t\tconst [r, g, b] = ctx.getImageData(0, 0, 1, 1).data;\n\t\tctx.clearRect(0, 0, 1, 1);\n\t\treturn `rgba(${r}, ${g}, ${b}, ${255 / a})`;\n\t}\n\n\tlet mode: \"categories\" | \"scores\";\n\n\t$: {\n\t\tif (!color_map) {\n\t\t\tcolor_map = {};\n\t\t}\n\t\tif (value.length > 0) {\n\t\t\tfor (let [_, label] of value) {\n\t\t\t\tif (label !== null) {\n\t\t\t\t\tif (typeof label === \"string\") {\n\t\t\t\t\t\tmode = \"categories\";\n\t\t\t\t\t\tif (!(label in color_map)) {\n\t\t\t\t\t\t\tlet color = get_next_color(Object.keys(color_map).length);\n\t\t\t\t\t\t\tcolor_map[label] = color;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmode = \"scores\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction correct_color_map() {\n\t\t\tfor (const col in color_map) {\n\t\t\t\tconst _c = color_map[col].trim();\n\t\t\t\tif (_c in colors) {\n\t\t\t\t\t_color_map[col] = colors[_c as keyof typeof colors];\n\t\t\t\t} else {\n\t\t\t\t\t_color_map[col] = {\n\t\t\t\t\t\tprimary: browser ? name_to_rgba(color_map[col], 1) : color_map[col],\n\t\t\t\t\t\tsecondary: browser\n\t\t\t\t\t\t\t? name_to_rgba(color_map[col], 0.5)\n\t\t\t\t\t\t\t: color_map[col]\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcorrect_color_map();\n\t}\n\n\tfunction handle_mouseover(label: string) {\n\t\tactive = label;\n\t}\n\tfunction handle_mouseout() {\n\t\tactive = \"\";\n\t}\n</script>\n\n<!-- \n\t@todo victor: try reimplementing without flex (negative margins on container to avoid left margin on linebreak). \n\tIf not possible hijack the copy execution like this:\n\n<svelte:window\n\ton:copy|preventDefault={() => {\n\t\tconst selection =.getSelection()?.toString();\n\t\tconsole.log(selection?.replaceAll(\"\\n\", \" \"));\n\t}}\n/>\n-->\n\n{#if mode === \"categories\"}\n\t{#if show_legend}\n\t\t<div\n\t\t\tclass=\"category-legend flex flex-wrap gap-1 mb-2 text-black mt-7\"\n\t\t\tdata-testid=\"highlighted-text:category-legend\"\n\t\t>\n\t\t\t{#each Object.entries(_color_map) as [category, color], i}\n\t\t\t\t<div\n\t\t\t\t\ton:mouseover={() => handle_mouseover(category)}\n\t\t\t\t\ton:focus={() => handle_mouseover(category)}\n\t\t\t\t\ton:mouseout={() => handle_mouseout()}\n\t\t\t\t\ton:blur={() => handle_mouseout()}\n\t\t\t\t\tclass=\"category-label px-2 rounded-sm font-semibold cursor-pointer\"\n\t\t\t\t\tstyle={\"background-color:\" + color.secondary}\n\t\t\t\t>\n\t\t\t\t\t{category}\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\t{/if}\n\t<div\n\t\tclass=\"textfield bg-white dark:bg-transparent rounded-sm text-sm box-border max-w-full break-word leading-7 mt-7\"\n\t\tdata-testid=\"highlighted-text:textfield\"\n\t>\n\t\t{#each value as [text, category]}\n\t\t\t<span\n\t\t\t\tclass=\"textspan rounded-sm px-1 transition-colors text-black  pb-[0.225rem] pt-[0.15rem]\"\n\t\t\t\tstyle:background-color={category === null ||\n\t\t\t\t(active && active !== category)\n\t\t\t\t\t? \"\"\n\t\t\t\t\t: _color_map[category].secondary}\n\t\t\t\tclass:dark:text-white={category === null ||\n\t\t\t\t\t(active && active !== category)}\n\t\t\t\tclass:hl={category !== null}\n\t\t\t>\n\t\t\t\t<span class=\"text \">{text}</span>\n\t\t\t\t{#if !show_legend && category !== null}\n\t\t\t\t\t&nbsp;<span\n\t\t\t\t\t\tclass=\"label mr-[-4px] font-bold uppercase text-xs inline-category  text-white rounded-sm  px-[0.325rem] mt-[0.05rem] py-[0.05rem] transition-colors\"\n\t\t\t\t\t\tstyle:background-color={category === null ||\n\t\t\t\t\t\t(active && active !== category)\n\t\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t\t: _color_map[category].primary}\n\t\t\t\t\t>\n\t\t\t\t\t\t{category}\n\t\t\t\t\t</span>\n\t\t\t\t{/if}</span\n\t\t\t>\n\t\t{/each}\n\t</div>\n{:else}\n\t{#if show_legend}\n\t\t<div\n\t\t\tclass=\"color_legend flex px-2 py-1 justify-between rounded mb-3 font-semibold mt-7\"\n\t\t\tdata-testid=\"highlighted-text:color-legend\"\n\t\t\tstyle=\"background: -webkit-linear-gradient(to right,#8d83d6,(255,255,255,0),#eb4d4b); background: linear-gradient(to right,#8d83d6,rgba(255,255,255,0),#eb4d4b);\"\n\t\t>\n\t\t\t<span>-1</span>\n\t\t\t<span>0</span>\n\t\t\t<span>+1</span>\n\t\t</div>\n\t{/if}\n\t<div\n\t\tclass=\"textfield p-2 bg-white dark:bg-gray-800 rounded box-border max-w-full break-word leading-7\"\n\t\tdata-testid=\"highlighted-text:textfield\"\n\t>\n\t\t{#each value as [text, score]}\n\t\t\t<span\n\t\t\t\tclass=\"textspan p-1 mr-0.5 bg-opacity-20 dark:bg-opacity-80 rounded-sm\"\n\t\t\t\tstyle={\"background-color: rgba(\" +\n\t\t\t\t\t(score < 0 ? \"141, 131, 214,\" + -score : \"235, 77, 75,\" + score) +\n\t\t\t\t\t\")\"}\n\t\t\t>\n\t\t\t\t<span class=\"text dark:text-white\">{text}</span>\n\t\t\t</span>\n\t\t{/each}\n\t</div>\n{/if}\n\n<style>\n\t.hl + .hl {\n\t\t@apply ml-1;\n\t}\n\n\t.textspan:last-child > .label {\n\t\t@apply mr-0;\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { HighlightedText } from \"@gradio/highlighted-text\";\n\timport { Block, BlockLabel } from \"@gradio/atoms\";\n\timport { TextHighlight } from \"@gradio/icons\";\n\timport StatusTracker from \"../StatusTracker/StatusTracker.svelte\";\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\n\timport type { Styles } from \"@gradio/utils\";\n\n\texport let elem_id: string = \"\";\n\texport let visible: boolean = true;\n\texport let value: Array<[string, string | number]>;\n\texport let show_legend: boolean;\n\texport let color_map: Record<string, string> = {};\n\texport let label: string;\n\texport let style: Styles = {};\n\n\t$: if (!style.color_map && Object.keys(color_map).length) {\n\t\tstyle.color_map = color_map;\n\t}\n\n\texport let loading_status: LoadingStatus;\n\n\tconst dispatch = createEventDispatcher<{ change: undefined }>();\n\n\t$: value, dispatch(\"change\");\n</script>\n\n<Block\n\ttest_id=\"highlighted-text\"\n\t{visible}\n\t{elem_id}\n\tdisable={typeof style.container === \"boolean\" && !style.container}\n>\n\t<StatusTracker {...loading_status} />\n\t{#if label}\n\t\t<BlockLabel\n\t\t\tIcon={TextHighlight}\n\t\t\t{label}\n\t\t\tdisable={typeof style.container === \"boolean\" && !style.container}\n\t\t/>\n\t{/if}\n\n\t{#if value}\n\t\t<HighlightedText {value} {show_legend} color_map={style.color_map} />\n\t{:else}\n\t\t<div class=\"h-full min-h-[6rem] flex justify-center items-center\">\n\t\t\t<div class=\"h-5 dark:text-white opacity-50\"><TextHighlight /></div>\n\t\t</div>\n\t{/if}\n</Block>\n","export { default as Component } from \"./HighlightedText.svelte\";\nexport const modes = [\"static\"];\n\nexport const document = (config: Record<string, any>) => ({\n\ttype: \"Array<[string, string | number]>\",\n\tdescription: \"list of text spans and corresponding label / value\"\n});\n"],"names":["document"],"mappings":"iiCAAA,SAUE,OAGC,iWC4HG,YAeG,0BAAL,8RAJH,+DAXK,oEAeG,uBAAL,6HAAA,0EAjEE,aAuBG,0BAAL,8SAJH,+DAnBK,8EAuBG,uBAAL,8HAAA;;kVA4BF,iDAqBsC,gMAJ7B,0BACL,OAAQ,EAAI,kBAAoB,MAAQ,eAAiB,OAC1D,GAAG,UAJL,SAMC,yCAAoC,8BAJ7B,0BACL,OAAQ,EAAI,kBAAoB,MAAQ,eAAiB,OAC1D,2DAjEK,OAAO,QAAQ,2BAApB,+NAJH,wEAIQ,OAAO,QAAQ,wBAApB,6HAAA,qDASC,+MAFM,oBAAsB,MAAM,SAAS,UAN7C,uIAQE,8BAFM,oBAAsB,MAAM,+EA+BjC,4BARmC,MAC/B,2NAEmB,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,6BALnB,6CAOJ,+CALuB,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,qEAPL,gBACf,MAAe,QAAa,8NALX,QAAa,MAClC,MAAU,OAAW,gBACb,QAAa,IAAI,yBANH,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,sBALzB,SAUC,wDAAqB,mBACf,MAAe,QAAa,0FALX,QAAa,MAClC,MAAU,OAAW,qBACb,QAAa,IAAI,+BANH,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,kFA9BvB,QAAS,gOArFP,SAAiB,UAAa,QAIzB,eACA,cAAuB,OACvB,kBAEP,EAEA,KACA,EAAS,cAES,EAAc,OAC9B,MACA,GAAS,SAAS,cAAc,QAAQ,EAC5C,EAAM,EAAO,WAAW,IAAI,EAE7B,EAAI,UAAY,EAChB,EAAI,SAAS,EAAG,EAAG,EAAG,CAAC,QAChB,EAAG,GAAG,IAAK,EAAI,aAAa,EAAG,EAAG,EAAG,CAAC,EAAE,KAC/C,SAAI,UAAU,EAAG,EAAG,EAAG,CAAC,UACT,MAAM,OAAM,OAAM,IAAM,QAGpC,cAwCsB,OACzB,EAAS,CAAK,mBAGd,EAAS,EAAE,aAwBY,EAAiB,CAAQ,OAC7B,EAAiB,CAAQ,QACtB,UACJ,uKAlDT,uBACG,KAAO,SACX,GAAK,EAAU,GAAK,OACtB,IAAM,OACT,EAAW,GAAO,EAAO,UAEzB,EAAW,IACV,QAAS,EAAU,EAAa,EAAU,GAAM,CAAC,EAAI,EAAU,GAC/D,UAAW,EACR,EAAa,EAAU,GAAM,EAAG,EAChC,EAAU,YA5BZ,OACJ,MAEG,EAAM,OAAS,WACR,EAAG,IAAU,MAClB,IAAU,cACF,IAAU,iBACpB,EAAO,YAAY,GACb,KAAS,QACV,GAAQ,GAAe,OAAO,KAAK,CAAS,EAAE,MAAM,MACxD,EAAU,GAAS,eAGpB,EAAO,QAAQ,EAqBnB,qLC1BO,4BAEU,MAAM,WAAc,YAAc,KAAM,uHAAxC,MAAM,WAAc,YAAc,KAAM,0TAOzD,SACC,uMAHiD,KAAM,6IAAN,KAAM,+IAVtC,kFACd,uDAQA,sMATc,qBACd,0fAHW,MAAM,WAAc,YAAc,KAAM,uLAAxC,MAAM,WAAc,YAAc,KAAM,+JAvB7C,UAAkB,OAClB,UAAmB,OACnB,YACA,kBACA,mBACA,YACA,eAMA,yBAEL,GAAW,yUANT,EAAM,WAAa,OAAO,KAAK,CAAS,EAAE,YACjD,EAAM,UAAY,mBAOT,EAAS,QAAQ,0LCxBf,IAAQ,CAAC,QAAQ,EAEjBA,GAAW,AAAC,KACxB,KAAM,mCACN,YAAa,oDACd"}