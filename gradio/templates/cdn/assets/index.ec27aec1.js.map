{"version":3,"file":"index.ec27aec1.js","sources":["../../../../ui/packages/icons/src/Maximise.svelte","../../../../ui/packages/icons/src/Pause.svelte","../../../../ui/packages/icons/src/Play.svelte","../../../../ui/packages/icons/src/Video.svelte","../../../../ui/packages/video/src/utils.ts","../../../../ui/packages/video/src/Player.svelte","../../../../ui/packages/video/src/Video.svelte","../../../../ui/packages/video/src/StaticVideo.svelte","../../../../ui/packages/app/src/components/Video/Video.svelte","../../../../ui/packages/app/src/components/Video/index.ts"],"sourcesContent":["<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"\n\t><path\n\t\td=\"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3\"\n\t/></svg\n>\n","<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"\n\t><rect x=\"6\" y=\"4\" width=\"4\" height=\"16\" /><rect\n\t\tx=\"14\"\n\t\ty=\"4\"\n\t\twidth=\"4\"\n\t\theight=\"16\"\n\t/></svg\n>\n","<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"><polygon points=\"5 3 19 12 5 21 5 3\" /></svg\n>\n","<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"\n\tclass=\"feather feather-video\"\n\t><polygon points=\"23 7 16 12 23 17 23 7\" /><rect\n\t\tx=\"1\"\n\t\ty=\"5\"\n\t\twidth=\"15\"\n\t\theight=\"14\"\n\t\trx=\"2\"\n\t\try=\"2\"\n\t/></svg\n>\n","export const prettyBytes = (bytes: number): string => {\n\tlet units = [\"B\", \"KB\", \"MB\", \"GB\", \"PB\"];\n\tlet i = 0;\n\twhile (bytes > 1024) {\n\t\tbytes /= 1024;\n\t\ti++;\n\t}\n\tlet unit = units[i];\n\treturn bytes.toFixed(1) + \" \" + unit;\n};\n\nexport const playable = (): boolean => {\n\t// let video_element = document.createElement(\"video\");\n\t// let mime_type = mime.lookup(filename);\n\t// return video_element.canPlayType(mime_type) != \"\";\n\treturn true; // FIX BEFORE COMMIT - mime import causing issues\n};\n","<script lang=\"ts\">\n\timport { tick } from \"svelte\";\n\timport { Play, Pause, Maximise, Undo } from \"@gradio/icons\";\n\n\texport let src: string;\n\texport let mirror: boolean;\n\n\tlet time: number = 0;\n\tlet duration: number;\n\tlet paused: boolean = true;\n\tlet video: HTMLVideoElement;\n\n\tlet show_controls = true;\n\tlet show_controls_timeout: NodeJS.Timeout;\n\n\tfunction video_move() {\n\t\tclearTimeout(show_controls_timeout);\n\t\tshow_controls_timeout = setTimeout(() => (show_controls = false), 2500);\n\t\tshow_controls = true;\n\t}\n\n\tfunction handleMove(e: TouchEvent | MouseEvent) {\n\t\tif (!duration) return;\n\n\t\tif (e.type === \"click\") {\n\t\t\thandle_click(e as MouseEvent);\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.type !== \"touchmove\" && !((e as MouseEvent).buttons & 1)) return;\n\n\t\tconst clientX =\n\t\t\te.type === \"touchmove\"\n\t\t\t\t? (e as TouchEvent).touches[0].clientX\n\t\t\t\t: (e as MouseEvent).clientX;\n\t\tconst { left, right } = (\n\t\t\te.currentTarget as HTMLProgressElement\n\t\t).getBoundingClientRect();\n\t\ttime = (duration * (clientX - left)) / (right - left);\n\t}\n\n\tfunction play_pause() {\n\t\tif (paused) video.play();\n\t\telse video.pause();\n\t}\n\n\tfunction handle_click(e: MouseEvent) {\n\t\tconst { left, right } = (\n\t\t\te.currentTarget as HTMLProgressElement\n\t\t).getBoundingClientRect();\n\t\ttime = (duration * (e.clientX - left)) / (right - left);\n\t}\n\n\tfunction format(seconds: number) {\n\t\tif (isNaN(seconds) || !isFinite(seconds)) return \"...\";\n\n\t\tconst minutes = Math.floor(seconds / 60);\n\t\tlet _seconds: number | string = Math.floor(seconds % 60);\n\t\tif (seconds < 10) _seconds = `0${_seconds}`;\n\n\t\treturn `${minutes}:${_seconds}`;\n\t}\n\n\tasync function _load() {\n\t\tawait tick();\n\t\tvideo.currentTime = 9999;\n\n\t\tsetTimeout(async () => {\n\t\t\tvideo.currentTime = 0.0;\n\t\t}, 50);\n\t}\n\n\t$: src && _load();\n</script>\n\n<div>\n\t<video\n\t\t{src}\n\t\tpreload=\"auto\"\n\t\ton:mousemove={video_move}\n\t\ton:click={play_pause}\n\t\ton:play\n\t\ton:pause\n\t\ton:ended\n\t\tbind:currentTime={time}\n\t\tbind:duration\n\t\tbind:paused\n\t\tbind:this={video}\n\t\tclass=\"w-full h-full object-contain bg-black\"\n\t\tclass:mirror\n\t>\n\t\t<track kind=\"captions\" />\n\t</video>\n\n\t<div\n\t\tclass=\"wrap absolute bottom-0 transition duration-500  m-1.5 bg-slate-800 px-1 py-2.5 rounded-md\"\n\t\tstyle=\"opacity: {duration && show_controls ? 1 : 0}\"\n\t\ton:mousemove={video_move}\n\t>\n\t\t<div class=\"flex w-full justify-space h-full items-center px-1.5 \">\n\t\t\t<span\n\t\t\t\tclass=\" w-6 cursor-pointer text-white flex justify-center\"\n\t\t\t\ton:click={play_pause}\n\t\t\t>\n\t\t\t\t{#if time === duration}\n\t\t\t\t\t<Undo />\n\t\t\t\t{:else if paused}\n\t\t\t\t\t<Play />\n\t\t\t\t{:else}\n\t\t\t\t\t<Pause />\n\t\t\t\t{/if}\n\t\t\t</span>\n\n\t\t\t<span class=\"font-mono shrink-0 text-xs mx-3 text-white\"\n\t\t\t\t>{format(time)} / {format(duration)}</span\n\t\t\t>\n\t\t\t<progress\n\t\t\t\tvalue={time / duration || 0}\n\t\t\t\ton:mousemove={handleMove}\n\t\t\t\ton:touchmove|preventDefault={handleMove}\n\t\t\t\ton:click|stopPropagation|preventDefault={handle_click}\n\t\t\t\tclass=\"rounded h-2 w-full mx-3\"\n\t\t\t/>\n\n\t\t\t<div\n\t\t\t\tclass=\"w-6 cursor-pointer text-white\"\n\t\t\t\ton:click={() => video.requestFullscreen()}\n\t\t\t>\n\t\t\t\t<Maximise />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<style lang=\"postcss\">\n\tspan {\n\t\ttext-shadow: 0 0 8px rgba(0, 0, 0, 0.5);\n\t}\n\n\tprogress::-webkit-progress-bar {\n\t\tborder-radius: 2px;\n\t\tbackground-color: rgba(255, 255, 255, 0.2);\n\t\toverflow: hidden;\n\t}\n\n\tprogress::-webkit-progress-value {\n\t\t/* border-radius: 2px; */\n\n\t\tbackground-color: rgba(255, 255, 255, 0.9);\n\t}\n\n\t.mirror {\n\t\ttransform: scaleX(-1);\n\t}\n\n\t.wrap {\n\t\twidth: calc(100% - 0.375rem * 2);\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { Upload, ModifyUpload } from \"@gradio/upload\";\n\timport type { FileData } from \"@gradio/upload\";\n\timport { BlockLabel } from \"@gradio/atoms\";\n\timport { Webcam } from \"@gradio/image\";\n\timport { Video } from \"@gradio/icons\";\n\n\timport { prettyBytes, playable } from \"./utils\";\n\timport Player from \"./Player.svelte\";\n\n\texport let value: FileData | null = null;\n\texport let source: string;\n\texport let label: string | undefined = undefined;\n\texport let show_label: boolean;\n\texport let mirror_webcam: boolean;\n\texport let include_audio: boolean;\n\n\texport let drop_text: string = \"Drop a video file\";\n\texport let or_text: string = \"or\";\n\texport let upload_text: string = \"click to upload\";\n\n\tconst dispatch = createEventDispatcher<{\n\t\tchange: FileData | null;\n\t\tclear: undefined;\n\t\tplay: undefined;\n\t\tpause: undefined;\n\t\tended: undefined;\n\t\tdrag: boolean;\n\t\terror: string;\n\t\tupload: FileData;\n\t}>();\n\n\tfunction handle_load({ detail }: CustomEvent<FileData | null>) {\n\t\tdispatch(\"change\", detail);\n\t\tdispatch(\"upload\", detail!);\n\t\tvalue = detail;\n\t}\n\n\tfunction handle_clear({ detail }: CustomEvent<FileData | null>) {\n\t\tvalue = null;\n\t\tdispatch(\"change\", detail);\n\t\tdispatch(\"clear\");\n\t}\n\n\tlet dragging = false;\n\t$: dispatch(\"drag\", dragging);\n</script>\n\n<BlockLabel {show_label} Icon={Video} label={label || \"Video\"} />\n{#if value === null}\n\t{#if source === \"upload\"}\n\t\t<Upload\n\t\t\tbind:dragging\n\t\t\tfiletype=\"video/mp4,video/x-m4v,video/*\"\n\t\t\ton:load={handle_load}\n\t\t>\n\t\t\t<div class=\"flex flex-col\">\n\t\t\t\t{drop_text}\n\t\t\t\t<span class=\"text-gray-300\">- {or_text} -</span>\n\t\t\t\t{upload_text}\n\t\t\t</div>\n\t\t</Upload>\n\t{:else if source === \"webcam\"}\n\t\t<Webcam\n\t\t\t{mirror_webcam}\n\t\t\t{include_audio}\n\t\t\tmode=\"video\"\n\t\t\ton:error\n\t\t\ton:capture={({ detail }) => dispatch(\"change\", detail)}\n\t\t/>\n\t{/if}\n{:else}\n\t<ModifyUpload on:clear={handle_clear} />\n\t{#if playable()}\n\t\t<!-- svelte-ignore a11y-media-has-caption -->\n\t\t<Player\n\t\t\tsrc={value.data}\n\t\t\ton:play\n\t\t\ton:pause\n\t\t\ton:ended\n\t\t\tmirror={mirror_webcam && source === \"webcam\"}\n\t\t/>\n\t{:else if value.size}\n\t\t<div class=\"file-name text-4xl p-6 break-all\">{value.name}</div>\n\t\t<div class=\"file-size text-2xl p-2\">\n\t\t\t{prettyBytes(value.size)}\n\t\t</div>\n\t{/if}\n{/if}\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { BlockLabel } from \"@gradio/atoms\";\n\timport type { FileData } from \"@gradio/upload\";\n\timport { Video } from \"@gradio/icons\";\n\n\timport Player from \"./Player.svelte\";\n\n\texport let value: FileData | null = null;\n\texport let label: string | undefined = undefined;\n\texport let show_label: boolean;\n\n\tconst dispatch = createEventDispatcher<{\n\t\tchange: FileData;\n\t\tplay: undefined;\n\t\tpause: undefined;\n\t\tended: undefined;\n\t}>();\n\n\t$: value && dispatch(\"change\", value);\n</script>\n\n<BlockLabel {show_label} Icon={Video} label={label || \"Video\"} />\n{#if value === null}\n\t<div class=\"h-full min-h-[15rem] flex justify-center items-center\">\n\t\t<div class=\"h-5 dark:text-white opacity-50\"><Video /></div>\n\t</div>\n{:else}\n\t<!-- svelte-ignore a11y-media-has-caption -->\n\t<Player src={value.data} on:play on:pause on:ended mirror={false} />\n{/if}\n","<script lang=\"ts\">\n\timport type { FileData } from \"@gradio/upload\";\n\timport { normalise_file } from \"@gradio/upload\";\n\timport { Block } from \"@gradio/atoms\";\n\timport { Video, StaticVideo } from \"@gradio/video\";\n\n\timport StatusTracker from \"../StatusTracker/StatusTracker.svelte\";\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\n\timport type { Styles } from \"@gradio/utils\";\n\timport { _ } from \"svelte-i18n\";\n\n\texport let elem_id: string = \"\";\n\texport let visible: boolean = true;\n\texport let value: FileData | null | string = null;\n\texport let label: string;\n\texport let source: string;\n\texport let root: string;\n\texport let root_url: null | string;\n\texport let show_label: boolean;\n\texport let loading_status: LoadingStatus;\n\texport let style: Styles = {};\n\texport let mirror_webcam: boolean;\n\texport let include_audio: boolean;\n\n\texport let mode: \"static\" | \"dynamic\";\n\n\tlet _value: null | FileData;\n\t$: _value = normalise_file(value, root_url ?? root);\n\n\tlet dragging = false;\n</script>\n\n<Block\n\t{visible}\n\tvariant={mode === \"dynamic\" && value === null && source === \"upload\"\n\t\t? \"dashed\"\n\t\t: \"solid\"}\n\tcolor={dragging ? \"green\" : \"grey\"}\n\tpadding={false}\n\t{elem_id}\n\tstyle={{ height: style.height, width: style.width }}\n>\n\t<StatusTracker {...loading_status} />\n\n\t{#if mode === \"static\"}\n\t\t<StaticVideo value={_value} {label} {show_label} />\n\t{:else}\n\t\t<Video\n\t\t\tvalue={_value}\n\t\t\ton:change={({ detail }) => (value = detail)}\n\t\t\ton:drag={({ detail }) => (dragging = detail)}\n\t\t\ton:error={({ detail }) => {\n\t\t\t\tloading_status = loading_status || {};\n\t\t\t\tloading_status.status = \"error\";\n\t\t\t\tloading_status.message = detail;\n\t\t\t}}\n\t\t\t{label}\n\t\t\t{show_label}\n\t\t\t{source}\n\t\t\tdrop_text={$_(\"interface.drop_video\")}\n\t\t\tor_text={$_(\"or\")}\n\t\t\tupload_text={$_(\"interface.click_to_upload\")}\n\t\t\t{mirror_webcam}\n\t\t\t{include_audio}\n\t\t\ton:change\n\t\t\ton:clear\n\t\t\ton:play\n\t\t\ton:pause\n\t\t\ton:upload\n\t\t/>\n\t{/if}\n</Block>\n","export { default as Component } from \"./Video.svelte\";\nexport const modes = [\"static\", \"dynamic\"];\n\nexport const document = (config: Record<string, any>) => ({\n\ttype: \"{ name: string; data: string }\",\n\tdescription: \"file name and base64 data of video file\"\n});\n"],"names":[],"mappings":"g/BAAA,SAUE,siBCVF,SAUE,OAA0C,icCV5C,SASyB,klBCTzB,SAWE,OAA0C,0GCX/B,IAAc,AAAC,GAA0B,IACjD,GAAQ,CAAC,IAAK,KAAM,KAAM,KAAM,IAAI,EACpC,EAAI,OACD,EAAQ,SACL,YAGN,GAAO,EAAM,SACV,GAAM,QAAQ,CAAC,EAAI,IAAM,CACjC,EAEa,GAAW,IAIhB,okBCmGF,GAAO,eAAU,GAAO,6JAVrB,QAAS,OAEJ,0KAQK,KAAG,6aAGX,KAAO,MAAY,gTArBX,MAAY,KAAgB,EAAI,CAAC,UArBpD,SACC,OAeC,uBAGD,OAKC,OACC,6BAaA,mCAGA,cAQA,iDA7Ca,kBACJ,gKAsBE,sBAgBI,yBACe,yBACY,4CAvB7B,gFAbI,sBAAA,sNA8Bd,GAAO,oCAAU,GAAO,oCAGnB,KAAO,MAAY,4CArBX,MAAY,KAAgB,EAAI,CAAC,gJA3CnC,MACX,MAAM,CAAO,IAAM,SAAS,CAAO,QAAU,WAE3C,GAAU,KAAK,MAAM,EAAU,EAAE,KACnC,GAA4B,KAAK,MAAM,EAAU,EAAE,QACnD,GAAU,IAAI,OAAe,QAEvB,KAAW,2BAxDX,UACA,YAEP,EAAe,EACf,EACA,EAAkB,GAClB,EAEA,EAAgB,GAChB,eAGH,aAAa,CAAqB,EAClC,EAAwB,mBAAkB,EAAgB,EAAK,EAAG,IAAI,MACtE,EAAgB,EAAI,aAGD,OACd,YAED,EAAE,OAAS,SACd,EAAa,CAAe,YAIzB,EAAE,OAAS,cAAkB,GAAiB,QAAU,eAEtD,GACL,EAAE,OAAS,YACP,EAAiB,QAAQ,GAAG,QAC5B,EAAiB,SACd,OAAM,SACb,EAAE,cACD,4BACF,EAAQ,EAAY,GAAU,GAAU,GAAQ,iBAI5C,EAAQ,EAAM,OACb,EAAM,mBAGU,SACb,OAAM,SACb,EAAE,cACD,4BACF,EAAQ,EAAY,GAAE,QAAU,GAAU,GAAQ,4BAc5C,UACN,EAAM,YAAc,QAEpB,yBACC,EAAM,YAAc,MAClB,8GAee,0IAGP,yBAuCO,EAAM,6HAtDtB,GAAO,uLCCc,iEACnB,UASK,KAAM,qfAhCX,QAAW,WAYN,OAAW,4WAqB2B,KAAM,gBAEnD,GAAY,KAAM,IAAI,0JAFxB,yBACA,oCAD+C,KAAM,6BAEnD,GAAY,KAAM,IAAI,yGATlB,KAAM,YAIH,MAAiB,OAAW,qJAJ/B,KAAM,sBAIH,MAAiB,OAAW,yrBA1B3B,oTAGP,4BAC2B,IAAE,MAAC,UAAQ,IAAE,YACxC,wEAHF,uBAEC,4DADC,iBAC8B,iBAC9B,2FAX0B,SAAc,MAAS,sDACjD,QAAU,8LAD8B,MAAS,ySAtC1C,QAAyB,SACzB,aACA,QAA4B,WAC5B,iBACA,oBACA,oBAEA,YAAoB,wBACpB,UAAkB,SAClB,cAAsB,0BAE3B,GAAW,iBAWM,WACtB,EAAS,SAAU,CAAM,EACzB,EAAS,SAAU,CAAO,MAC1B,EAAQ,CAAM,cAGS,eACvB,EAAQ,IAAI,EACZ,EAAS,SAAU,CAAM,EACzB,EAAS,OAAO,KAGb,GAAW,qEAwBE,YAAa,EAAS,SAAU,CAAM,odAvBpD,EAAS,OAAQ,CAAQ,uQCjBf,KAAM,YAAwC,4IAA9C,KAAM,sTALnB,SACC,uLAH6B,SAAc,MAAS,sDACjD,QAAU,8LAD8B,MAAS,ySAd1C,QAAyB,SACzB,QAA4B,WAC5B,qBAEL,GAAW,mPAOd,GAAS,EAAS,SAAU,CAAK,kKC6B3B,uDAWI,MAAG,sBAAsB,UAC3B,MAAG,IAAI,cACH,MAAG,2BAA2B,oSAbpC,iGAWI,MAAG,sBAAsB,sBAC3B,MAAG,IAAI,0BACH,MAAG,2BAA2B,8MAhBxB,oHAAA,wLAHF,uHAEd,SAAS,mKAFK,wVARV,QAAS,WAAa,OAAU,MAAQ,OAAW,SACzD,SACA,cACI,MAAW,QAAU,eACnB,uBAEA,OAAQ,KAAM,OAAQ,MAAO,KAAM,2JANnC,QAAS,WAAa,OAAU,MAAQ,OAAW,SACzD,SACA,0BACI,MAAW,QAAU,+CAGnB,OAAQ,KAAM,OAAQ,MAAO,KAAM,6LA7BjC,UAAkB,OAClB,UAAmB,OACnB,QAAkC,SAClC,YACA,aACA,WACA,eACA,iBACA,qBACA,eACA,oBACA,oBAEA,UAEP,EAGA,EAAW,aAoBC,gBAAc,EAAQ,CAAM,MAC9B,iBAAc,EAAW,CAAM,MAC9B,iBACZ,EAAiB,WACjB,EAAe,OAAS,eACxB,EAAe,QAAU,opBA3BzB,EAAS,GAAe,EAAO,GAAY,CAAI,mRC1BtC,IAAQ,CAAC,SAAU,SAAS,EAE5B,GAAW,AAAC,KACxB,KAAM,iCACN,YAAa,yCACd"}