{"version":3,"file":"index-3d3fec2d.js","sources":["../../../../js/app/src/components/AnnotatedImage/AnnotatedImage.svelte","../../../../js/app/src/components/AnnotatedImage/index.ts"],"sourcesContent":["<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { Block, BlockLabel, Empty } from \"@gradio/atoms\";\n\timport { Image } from \"@gradio/icons\";\n\timport StatusTracker from \"../StatusTracker/StatusTracker.svelte\";\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\n\timport { FileData, normalise_file } from \"@gradio/upload\";\n\timport type { SelectData } from \"@gradio/utils\";\n\timport type { Styles } from \"@gradio/utils\";\n\n\texport let elem_id: string = \"\";\n\texport let elem_classes: Array<string> = [];\n\texport let visible: boolean = true;\n\texport let value: [FileData, Array<[FileData, string]>] | null;\n\tlet old_value: [FileData, Array<[FileData, string]>] | null;\n\tlet _value: [FileData, Array<[FileData, string]>] | null;\n\texport let label: string = \"Annotated Image\";\n\texport let show_label: boolean = true;\n\texport let show_legend: boolean = true;\n\texport let style: Styles = {};\n\texport let root: string;\n\texport let root_url: string;\n\tlet active: string | null = null;\n\n\texport let loading_status: LoadingStatus;\n\n\tconst dispatch = createEventDispatcher<{\n\t\tchange: undefined;\n\t\tselect: SelectData;\n\t}>();\n\n\t$: {\n\t\tif (value !== old_value) {\n\t\t\told_value = value;\n\t\t\tdispatch(\"change\");\n\t\t}\n\t\tif (value) {\n\t\t\t_value = [\n\t\t\t\tnormalise_file(value[0], root, root_url) as FileData,\n\t\t\t\tvalue[1].map(([file, label]) => [\n\t\t\t\t\tnormalise_file(file, root, root_url) as FileData,\n\t\t\t\t\tlabel\n\t\t\t\t])\n\t\t\t];\n\t\t} else {\n\t\t\t_value = null;\n\t\t}\n\t}\n\tfunction handle_mouseover(label: string) {\n\t\tactive = label;\n\t}\n\tfunction handle_mouseout() {\n\t\tactive = null;\n\t}\n</script>\n\n<Block\n\t{visible}\n\t{elem_id}\n\t{elem_classes}\n\tpadding={false}\n\tstyle={{\n\t\theight: style.height,\n\t\twidth: style.width\n\t}}\n\tallow_overflow={false}\n>\n\t<StatusTracker {...loading_status} />\n\t<BlockLabel {show_label} Icon={Image} label={label || \"Image\"} />\n\n\t<div class=\"container\">\n\t\t{#if _value == null}\n\t\t\t<Empty size=\"large\" unpadded_box={true}><Image /></Empty>\n\t\t{:else}\n\t\t\t<div class=\"image-container\">\n\t\t\t\t<!-- svelte-ignore a11y-missing-attribute -->\n\t\t\t\t<img\n\t\t\t\t\tclass=\"base-image\"\n\t\t\t\t\tclass:fit-height={style.height}\n\t\t\t\t\tsrc={_value ? _value[0].data : null}\n\t\t\t\t/>\n\t\t\t\t{#each _value ? _value[1] : [] as [file, label], i}\n\t\t\t\t\t<!-- svelte-ignore a11y-missing-attribute -->\n\t\t\t\t\t<img\n\t\t\t\t\t\tclass=\"mask fit-height\"\n\t\t\t\t\t\tclass:active={active == label}\n\t\t\t\t\t\tclass:inactive={active != label && active != null}\n\t\t\t\t\t\tsrc={file.data}\n\t\t\t\t\t\tstyle={style.color_map && label in style.color_map\n\t\t\t\t\t\t\t? null\n\t\t\t\t\t\t\t: `filter: hue-rotate(${Math.round(\n\t\t\t\t\t\t\t\t\t(i * 360) / _value[1].length\n\t\t\t\t\t\t\t  )}deg);`}\n\t\t\t\t\t/>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t\t{#if show_legend && _value}\n\t\t\t\t<div class=\"legend\">\n\t\t\t\t\t{#each _value[1] as [_, label], i}\n\t\t\t\t\t\t<!-- svelte-ignore a11y-click-events-have-key-events -->\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"legend-item\"\n\t\t\t\t\t\t\tstyle=\"background-color: {style.color_map &&\n\t\t\t\t\t\t\tlabel in style.color_map\n\t\t\t\t\t\t\t\t? style.color_map[label] + '88'\n\t\t\t\t\t\t\t\t: `hsla(${Math.round(\n\t\t\t\t\t\t\t\t\t\t(i * 360) / _value[1].length\n\t\t\t\t\t\t\t\t  )}, 100%, 50%, 0.3)`}\"\n\t\t\t\t\t\t\ton:mouseover={() => handle_mouseover(label)}\n\t\t\t\t\t\t\ton:focus={() => handle_mouseover(label)}\n\t\t\t\t\t\t\ton:mouseout={() => handle_mouseout()}\n\t\t\t\t\t\t\ton:blur={() => handle_mouseout()}\n\t\t\t\t\t\t\ton:click={() => dispatch(\"select\", { index: i, value: label })}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{label}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t{/if}\n\t</div>\n</Block>\n\n<style>\n\t.container {\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t}\n\t.image-container {\n\t\tposition: relative;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tflex-grow: 1;\n\t\twidth: 100%;\n\t\toverflow: hidden;\n\t}\n\t.fit-height {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tobject-fit: contain;\n\t}\n\t.mask {\n\t\topacity: 0.85;\n\t\ttransition: all 0.2s ease-in-out;\n\t}\n\t.image-container:hover .mask {\n\t\topacity: 0.3;\n\t}\n\t.mask.active {\n\t\topacity: 1;\n\t}\n\t.mask.inactive {\n\t\topacity: 0;\n\t}\n\t.legend {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tflex-wrap: wrap;\n\t\talign-content: center;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tgap: var(--spacing-sm);\n\t\tpadding: var(--spacing-sm);\n\t}\n\t.legend-item {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tcursor: pointer;\n\t\tborder-radius: var(--radius-sm);\n\t\tpadding: var(--spacing-sm);\n\t}\n</style>\n","export { default as Component } from \"./AnnotatedImage.svelte\";\nexport const modes = [\"static\"];\n\nexport const document = (config: Record<string, any>) => ({\n\ttype: {\n\t\tpayload: \"[string, Array<[string, string]>]\"\n\t},\n\tdescription: {\n\t\tpayload:\n\t\t\t\"path to base image, followed by a list of tuples [mask image path, label]\"\n\t}\n});\n"],"names":["ctx","i","if_block","create_if_block_1","src_url_equal","img","img_src_value","attr","toggle_class","insert","target","div","anchor","append","dirty","img_style_value","each_value","set_style","set_data","t0","t0_value","Image","blocklabel_changes","elem_id","$$props","elem_classes","visible","value","old_value","_value","label","show_label","show_legend","style","root","root_url","active","loading_status","dispatch","createEventDispatcher","handle_mouseover","$$invalidate","handle_mouseout","mouseover_handler","focus_handler","normalise_file","file","modes","document","config"],"mappings":"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"}